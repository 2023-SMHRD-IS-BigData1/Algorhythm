<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>TABRO</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="../assets/img/logo.png" rel="shortcut icon" type="image/x-icon">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
          rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="../assets/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Template Main CSS File -->
    <link href="../assets/CSS/contact.css" rel="stylesheet">

    <link  rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <script defer src="../JS/contact.js"></script>

    <!-- =======================================================
    * Template Name: MeFamily
    * Updated: Sep 18 2023 with Bootstrap v5.3.2
    * Template URL: https://bootstrapmade.com/family-multipurpose-html-bootstrap-template-free/
    * Author: BootstrapMade.com
    * License: https://bootstrapmade.com/license/
    ======================================================== -->
</head>

<body>

<main class="main">
    <section class="home">
        <h1>Welcome to the <span>TABRO</span></h1>
        <button class="btn" id="sign-up">회원가입</button>
        <button class="btn" id="sign-in">로그인</button>
        <p><a class="link-copy" href="https://blog.naver.com/yumni_-" target="_blank">©Copyright 2023 TABRO</a></p>
    </section>

    <section class="sign-up">
        <article class="signup-left">
            <h1>TABRO</h1>
            <div class="wc_message">
                <p>WELCOME TO THE</p>
                <h3>TABRO</h3>
            </div>
            <div class="btn-back">
                <i class="fas fa-2x fa-angle-left angle-left-color"></i>
                HOME
            </div>
        </article>

        <article class="form-area">
            <!-- 회원가입 -->
            <div class="organize-form form-area-signup">
                <h2>JOIN US</h2>
                <form class="form" th:action="@{/user/join}" th:object="${userDTO}" method="post" id="join-form">
                    <div class="form-field btn_ris">
                        <!-- <label for="userId">ID를 입력해주세요</label> -->
                        <input type="text" id="userIdJoin" th:field="*{userId}" class="regis" placeholder="ID를 입력해주세요"/>
                        <button onclick="checkUserId()" type="button" class="w3-button w3-white w3-border w3-border-green w3-round-large">중복체크</button>
                        <span id="availability-message"></span>
                    </div>

                    <div class="form-field">
                        <!-- <label for="userPw">비밀번호를 입력해주세요</label> -->
                        <input type="password" id="userPw" th:field="*{userPw}" placeholder="PW를 입력해주세요"/>
                    </div>

                    <div class="form-field">
                        <!-- <label for="userPw2">비밀번호를 확인해주세요</label> -->
                        <input type="password" id="userPw2" name="userPw2" placeholder="PW를 확인해주세요"/>
                    </div>

                    <div class="form-field">
                        <!-- <label for="userName">이름을 입력해주세요</label> -->
                        <input type="text" id="userName" th:field="*{userNickname}" placeholder="이름을 입력해주세요"/>
                    </div>

                    <button class="btn-sign btn-up" id="joinBtn" onclick="validateForm()">회원가입</button>
                </form>
                <p style="margin-top:10px;">아이디가 있으신가요? <a class="link-in" href="#"> 로그인</a></p>
                <div class="phone">
                    <img alt="" class="phone_img" src="../assets/img/mobile_2.png">
                </div>
            </div>

            <!-- 로그인 -->
            <div class="organize-form form-area-signin">
                <h2>LOGIN</h2>
                <form action="/user" class="form" method="post" name="login-Form" th:object="${userDTO}">
                    <div class="form-field">
                        <!-- <label for="userId">ID</label> -->
                        <input id="userId" placeholder="ID를 입력해주세요" th:field="*{userId}" type="text"/>
                    </div>

                    <div class="form-field">
                        <!-- <label for="userPw">Password</label> -->
                        <input id="userPw" placeholder="PW를 입력해주세요" th:field="*{userPw}" type="password"/>
                        <span id="pw-match-message" style="color: red;"></span>
                    </div>

                    <button class="btn-sign btn-in">로그인</button>

                </form>
                <p>아이디가 없으신가요?<a class="link-up" href="#"> 회원가입</a></p>
                <div class="phone">
                    <img alt="" class="phone_img" src="../assets/img/mobile_2.png">
                </div>
            </div>

        </article>

        <article class="signup-right">

            <img alt="" class="webLogin" height="100% " src="../assets/img/loginPt.png" width="100%">

            <i class="fas fa-2x fa-bars bars-style"></i>
            <!-- <p><a class="link-copy" href="https://blog.naver.com/yumni_-" target="_blank">©Copyright 2023 TABRO</a></p> -->

        </article>
    </section>
</main>
<div class="modal fade" id="myModal" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content panel-info" id="checkId">
            <div class="modal-header panel-heading">
                <button class="close" data-dismiss="modal" type="button"></button>
                <h4 class="modal-title">확인</h4>
            </div>
            <div class="modal-body">
                <p id="checkMessage" style="color:black;font-size:large"></p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-default" data-dismiss="modal" type="button">Close</button>
            </div>
        </div>

    </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>

<!-- Bootstrap JS도 포함하세요 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<!-- 기존의 HTML 코드 -->
<script th:inline="javascript">
    var checkUser=[[${message}]]
       if (checkUser ===false){
        $(document).ready(function () {
               // 모달 창 띄우기
               $('#myModal').modal('show');
               // 모달 창 내용 설정
               $('#checkMessage').text('회원 정보를 다시 확인해주세요.');
           });
       }



function checkUserId(){
    var userId = $("#userIdJoin").val()
    var availabilityMessage = document.getElementById("availability-message");
    $.ajax({
        url: "/user",
        data: {"userId": userId},
        success: function(response) {
            console.log(response)
            if(response === true){
                availabilityMessage.innerHTML = "사용 가능한 아이디입니다.";
                availabilityMessage.style.color = "green";
                document.getElementById("join-form").submit.disabled = false;
            }else {
             availabilityMessage.innerHTML = "이미 존재하는 아이디입니다.";
             availabilityMessage.style.color = "red";
              document.getElementById("join-form").submit.disabled = true;
            }

        },
        error() {
            console.log("error")
        }
    });
}


</script>
</body>
</html>